version: '3'
services:
  apollo-router-custom-main:
    profiles: ["router", "all"]
    container_name: apollo-router-custom-main
    build: ./router/custom-main
    volumes:
      - ./supergraph.graphql:/dist/schema/supergraph.graphql
      - ./router.yaml:/dist/config/router.yaml
    command: [ "--dev", "-c", "config/router.yaml", "-s", "schema/supergraph.graphql", "--log", "info" ]
    ports:
      - "4000:4000"
  products:
    profiles: ["subgraphs", "all"]
    container_name: products
    build: ./subgraphs/products
  inventory:
    profiles: ["subgraphs", "all"]
    container_name: inventory
    build: ./subgraphs/inventory
  users:
    profiles: ["subgraphs", "all"]
    container_name: users
    build: ./subgraphs/users
  pandas:
    profiles: ["subgraphs", "all"]
    container_name: pandas
    build: ./subgraphs/pandas
  reviews:
    profiles: ["subgraphs", "all"]
    container_name: reviews
    build: ./subgraphs/reviews
